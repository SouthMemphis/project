# Проект по автоматической суммаризации текстов с применением нейронных сетей
## Структура репозитория
* fine-tuning.ipynb - файл с теоретическим отчётом и описанием процесса тонкой настройки LLM под домен.
* requirments.txt - библиотеки из окружения.
* web.py - Веб-интерфейс приложения, использующего настроенную модель 
* Video_2024_05_15-1.webm - демонстрация работы приложения</br>
Набор данных, на котором производилось обучение и оценка качества: IlyaGusev/gazeta

### Метрики качества обученной модели
![изображение](https://github.com/SouthMemphis/project/assets/92672290/58b5f068-8deb-4f2b-b9d8-2d3b6a8e1fc1)
### Использование модели из Hugging face:
```
from peft import PeftModel, PeftConfig
from transformers import AutoModelForCausalLM

config = PeftConfig.from_pretrained("SouthMemphis/Saiga-lora-2048-2epochs")
base_model = AutoModelForCausalLM.from_pretrained("IlyaGusev/saiga_mistral_7b_merged")
model = PeftModel.from_pretrained(base_model, "SouthMemphis/Saiga-lora-2048-2epochs")
```
### Пример работы модели:

'Глава правительства Японии Юкио Хатояма официально объявил о намерении уйти в отставку, передает ИТАР-ТАСС со ссылкой на телеканал NCHK. О своем решении он уже уведомил возглавляемую им Демократическую партию Японии. Хатояма принес извинения избирателям за то, что не смог выполнить предвыборное обещание — вывести американскую базу Футэмма за пределы префектуры Окинава. «Я приношу извинения за то, что нам не удалось вывести базу Футэмма за пределы префектуры Окинава, но мы продолжим к этому стремиться», — заявил глава правительства. «В современных условиях японо-американское сотрудничество необходимо для обеспечения безопасности не только нашей страны, но и всего региона», — пояснил он. Вместе с премьер-министром решил уйти в отставку генеральный секретарь ДПЯ Итиро Одзава. Он выразил надежду, что благодаря усилиям партии в стране станет обязательно лучше, и пригласил Социал-демократическую партию, вышедшую из правящей коалиции 30 мая, вернуться к сотрудничеству. Перенос американской военной базы Футэмма стал одним из предвыборных лозунгов Демпартии на выборах в сентябре прошлого года. Однако в ноябре на переговорах американский президент Барак Обама и Хатояма обошли этот вопрос стороной. На прошлой неделе японский премьер-министр объявил, что вывести базу из префектуры Окинава невозможно, однако она будет передислоцирована в менее населенный район одноименного острова. После этого решения в правящей коалиции начался разлад — не все согласились подписывать документ о передислокации базы. Глава социал-демократов Мидзухо Фукусиму была уволена с поста министра по делам потребителей за отказ подписывать документ. В ответ на это руководство Социал-демократической партии приняло решение о выходе из коалиции. К решению Хатоямы политические круги страны отнеслись неоднозначно. «Я сожалею. Премьер-министр Хатояма предпринял множество мер, в частности, выдачу пособий на детей и другие. И мог бы заслужить более высокую оценку со стороны народа», — заявил перед журналистами заместитель главы комитета по парламентской политике Вакио Мицуи, сообщает РИА «Новости». Оппозиционная Либерально-демократическая партия считает, что так демократы решили «подкрасить фасад» перед выборами в верхнюю палату парламента, которые состоятся в июле. «Отставка именно сейчас (преследует) исключительно предвыборные цели. Я считаю, что необходимо спросить мнение народа о доверии (партии демократов)», — заявил на пресс-конференции председатель ЛДП Садакадзу Танигаки. Демократическая партия победила на досрочных выборах в парламент в сентябре 2009 года, серьезно опередив правящую на тот момент ЛДПЯ. Причиной поражения стал финансовый кризис. После победы демократов Хатояма был утвержден премьер-министром. Сейчас уже звучат призывы провести очередные досрочные выборы в нижнюю палату, поскольку Демпартия не оправдала доверия избирателей. Однако решения по этому вопросу пока нет.'
```
eval_prompt = f"""Тебе на вход поступает русскоязычная статья из газеты. Твоя задача - выполнить суммаризацию этой статьи. Выдели из статьи наиболее релевантные фрагменты и по ним составь её суммаризацию.

### Статья:
{dataset['text'][27]}

### Её суммаризация:"""
model_input = tokenizer(eval_prompt, return_tensors="pt").to("cuda")

model.eval()
with torch.no_grad():
    result = tokenizer.decode(model.generate(**model_input, max_new_tokens=600)[0], skip_special_tokens=False)
    eval = result[result.find("Её суммаризация:") + len("Её суммаризация:") + 1:result.find("</s><s>")]
    print(eval)
Вывод:Премьер-министр Японии Юкио Хатояма объявил о намерении уйти в отставку. Он не смог выполнить обещание вывести американскую базу Футэмма за пределы префектуры Окинава. Вместе с Хатоямой уходит в отставку генеральный секретарь его партии Итиро Одзава. Политические круги Японии считают, что демократы решили «подкрасить фасад» перед выборами в верхнюю палату парламента.
```
